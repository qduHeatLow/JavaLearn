{"remainingRequest":"C:\\cangqiongwaimai\\苍穹外卖前端课程\\代码\\day02\\project-sky-admin-vue-ts\\node_modules\\babel-loader\\lib\\index.js!C:\\cangqiongwaimai\\苍穹外卖前端课程\\代码\\day02\\project-sky-admin-vue-ts\\node_modules\\ts-loader\\index.js??ref--14-2!C:\\cangqiongwaimai\\苍穹外卖前端课程\\代码\\day02\\project-sky-admin-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\cangqiongwaimai\\苍穹外卖前端课程\\代码\\day02\\project-sky-admin-vue-ts\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\cangqiongwaimai\\苍穹外卖前端课程\\代码\\day02\\project-sky-admin-vue-ts\\src\\views\\dashboard\\components\\orderList.vue?vue&type=script&lang=ts&","dependencies":[{"path":"C:\\cangqiongwaimai\\苍穹外卖前端课程\\代码\\day02\\project-sky-admin-vue-ts\\src\\views\\dashboard\\components\\orderList.vue","mtime":1706604704761},{"path":"C:\\cangqiongwaimai\\苍穹外卖前端课程\\代码\\day02\\project-sky-admin-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\cangqiongwaimai\\苍穹外卖前端课程\\代码\\day02\\project-sky-admin-vue-ts\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\cangqiongwaimai\\苍穹外卖前端课程\\代码\\day02\\project-sky-admin-vue-ts\\node_modules\\ts-loader\\index.js","mtime":499162500000},{"path":"C:\\cangqiongwaimai\\苍穹外卖前端课程\\代码\\day02\\project-sky-admin-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\cangqiongwaimai\\苍穹外卖前端课程\\代码\\day02\\project-sky-admin-vue-ts\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"C:\\\\cangqiongwaimai\\\\\\u82CD\\u7A79\\u5916\\u5356\\u524D\\u7AEF\\u8BFE\\u7A0B\\\\\\u4EE3\\u7801\\\\day02\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"C:\\\\cangqiongwaimai\\\\\\u82CD\\u7A79\\u5916\\u5356\\u524D\\u7AEF\\u8BFE\\u7A0B\\\\\\u4EE3\\u7801\\\\day02\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/defineProperty\"));\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"C:\\\\cangqiongwaimai\\\\\\u82CD\\u7A79\\u5916\\u5356\\u524D\\u7AEF\\u8BFE\\u7A0B\\\\\\u4EE3\\u7801\\\\day02\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"C:\\\\cangqiongwaimai\\\\\\u82CD\\u7A79\\u5916\\u5356\\u524D\\u7AEF\\u8BFE\\u7A0B\\\\\\u4EE3\\u7801\\\\day02\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"C:\\\\cangqiongwaimai\\\\\\u82CD\\u7A79\\u5916\\u5356\\u524D\\u7AEF\\u8BFE\\u7A0B\\\\\\u4EE3\\u7801\\\\day02\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/createClass\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"C:\\\\cangqiongwaimai\\\\\\u82CD\\u7A79\\u5916\\u5356\\u524D\\u7AEF\\u8BFE\\u7A0B\\\\\\u4EE3\\u7801\\\\day02\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"C:\\\\cangqiongwaimai\\\\\\u82CD\\u7A79\\u5916\\u5356\\u524D\\u7AEF\\u8BFE\\u7A0B\\\\\\u4EE3\\u7801\\\\day02\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/getPrototypeOf\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"C:\\\\cangqiongwaimai\\\\\\u82CD\\u7A79\\u5916\\u5356\\u524D\\u7AEF\\u8BFE\\u7A0B\\\\\\u4EE3\\u7801\\\\day02\\\\project-sky-admin-vue-ts\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/inherits\"));\n\nvar _tslib = require(\"tslib\");\n\nvar _vuePropertyDecorator = require(\"vue-property-decorator\");\n\nvar _index = _interopRequireDefault(require(\"@/components/Empty/index.vue\"));\n\nvar _order = require(\"@/api/order\");\n\nvar default_1 =\n/*#__PURE__*/\nfunction (_Vue) {\n  (0, _inherits2.default)(default_1, _Vue);\n\n  function default_1() {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, default_1);\n    _this = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(default_1).apply(this, arguments));\n    _this.orderId = ''; //订单号\n\n    _this.dialogOrderStatus = 0; //弹窗所需订单状态，用于详情展示字段\n\n    _this.activeIndex = 0;\n    _this.dialogVisible = false; //详情弹窗\n\n    _this.cancelDialogVisible = false; //取消，拒单弹窗\n\n    _this.cancelDialogTitle = ''; //取消，拒绝弹窗标题\n\n    _this.cancelReason = '';\n    _this.remark = ''; //自定义原因\n\n    _this.diaForm = [];\n    _this.row = {};\n    _this.isAutoNext = true;\n    _this.isSearch = false;\n    _this.counts = 0;\n    _this.page = 1;\n    _this.pageSize = 10;\n    _this.status = 2;\n    _this.orderData = [];\n    _this.isTableOperateBtn = true;\n    _this.cancelOrderReasonList = [{\n      value: 1,\n      label: '订单量较多，暂时无法接单'\n    }, {\n      value: 2,\n      label: '菜品已销售完，暂时无法接单'\n    }, {\n      value: 3,\n      label: '餐厅已打烊，暂时无法接单'\n    }, {\n      value: 0,\n      label: '自定义原因'\n    }];\n    _this.cancelrReasonList = [{\n      value: 1,\n      label: '订单量较多，暂时无法接单'\n    }, {\n      value: 2,\n      label: '菜品已销售完，暂时无法接单'\n    }, {\n      value: 3,\n      label: '骑手不足无法配送'\n    }, {\n      value: 4,\n      label: '客户电话取消'\n    }, {\n      value: 0,\n      label: '自定义原因'\n    }];\n    _this.orderList = [{\n      label: '全部订单',\n      value: 0\n    }, {\n      label: '待付款',\n      value: 1\n    }, {\n      label: '待接单',\n      value: 2\n    }, {\n      label: '待派送',\n      value: 3\n    }, {\n      label: '派送中',\n      value: 4\n    }, {\n      label: '已完成',\n      value: 5\n    }, {\n      label: '已取消',\n      value: 6\n    }];\n    return _this;\n  }\n\n  (0, _createClass2.default)(default_1, [{\n    key: \"created\",\n    value: function created() {\n      this.getOrderListData(this.status);\n    } // // 获取订单数据\n\n  }, {\n    key: \"getOrderListData\",\n    value: function () {\n      var _getOrderListData = (0, _asyncToGenerator2.default)(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(status) {\n        var params, data, row;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                params = {\n                  page: this.page,\n                  pageSize: this.pageSize,\n                  status: status\n                };\n                _context.next = 3;\n                return (0, _order.getOrderDetailPage)(params);\n\n              case 3:\n                data = _context.sent;\n                this.orderData = data.data.data.records;\n                this.counts = data.data.data.total;\n                this.$emit('getOrderListBy3Status');\n\n                if (!(this.dialogOrderStatus === 2 && this.status === 2 && this.isAutoNext && !this.isTableOperateBtn && data.data.records.length > 1)) {\n                  _context.next = 12;\n                  break;\n                }\n\n                row = data.data.records[0];\n                this.goDetail(row.id, row.status, row, row);\n                _context.next = 13;\n                break;\n\n              case 12:\n                return _context.abrupt(\"return\", null);\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getOrderListData(_x) {\n        return _getOrderListData.apply(this, arguments);\n      }\n\n      return getOrderListData;\n    }() //接单\n\n  }, {\n    key: \"orderAccept\",\n    value: function orderAccept(row, event) {\n      var _this2 = this;\n\n      event.stopPropagation();\n      this.orderId = row.id;\n      this.dialogOrderStatus = row.status;\n      (0, _order.orderAccept)({\n        id: this.orderId\n      }).then(function (res) {\n        if (res.data.code === 1) {\n          _this2.$message.success('操作成功');\n\n          _this2.orderId = ''; // this.dialogOrderStatus = 0\n\n          _this2.dialogVisible = false;\n\n          _this2.getOrderListData(_this2.status);\n        } else {\n          _this2.$message.error(res.data.msg);\n        }\n      }).catch(function (err) {\n        _this2.$message.error('请求出错了：' + err.message);\n      });\n    } //打开取消订单弹窗\n\n  }, {\n    key: \"cancelOrder\",\n    value: function cancelOrder(row, event) {\n      event.stopPropagation();\n      this.cancelDialogVisible = true;\n      this.orderId = row.id;\n      this.dialogOrderStatus = row.status;\n      this.cancelDialogTitle = '取消';\n      this.dialogVisible = false;\n      this.cancelReason = '';\n    } //打开拒单弹窗\n\n  }, {\n    key: \"orderReject\",\n    value: function orderReject(row, event) {\n      event.stopPropagation();\n      this.cancelDialogVisible = true;\n      this.orderId = row.id;\n      this.dialogOrderStatus = row.status;\n      this.cancelDialogTitle = '拒绝';\n      this.dialogVisible = false;\n      this.cancelReason = '';\n    } //确认取消或拒绝订单并填写原因\n\n  }, {\n    key: \"confirmCancel\",\n    value: function confirmCancel(type) {\n      var _this3 = this;\n\n      if (!this.cancelReason) {\n        return this.$message.error(\"\\u8BF7\\u9009\\u62E9\".concat(this.cancelDialogTitle, \"\\u539F\\u56E0\"));\n      } else if (this.cancelReason === '自定义原因' && !this.remark) {\n        return this.$message.error(\"\\u8BF7\\u8F93\\u5165\".concat(this.cancelDialogTitle, \"\\u539F\\u56E0\"));\n      }\n\n      ;\n      (this.cancelDialogTitle === '取消' ? _order.orderCancel : _order.orderReject)((0, _defineProperty2.default)({\n        id: this.orderId\n      }, this.cancelDialogTitle === '取消' ? 'cancelReason' : 'rejectionReason', this.cancelReason === '自定义原因' ? this.remark : this.cancelReason)).then(function (res) {\n        if (res.data.code === 1) {\n          _this3.$message.success('操作成功');\n\n          _this3.cancelDialogVisible = false;\n          _this3.orderId = ''; // this.dialogOrderStatus = 0\n\n          _this3.getOrderListData(_this3.status);\n        } else {\n          _this3.$message.error(res.data.msg);\n        }\n      }).catch(function (err) {\n        _this3.$message.error('请求出错了：' + err.message);\n      });\n    } // 派送，完成\n\n  }, {\n    key: \"cancelOrDeliveryOrComplete\",\n    value: function cancelOrDeliveryOrComplete(status, id, event) {\n      var _this4 = this;\n\n      event.stopPropagation();\n      var params = {\n        status: status,\n        id: id\n      };\n      (status === 3 ? _order.deliveryOrder : _order.completeOrder)(params).then(function (res) {\n        if (res.data.code === 1) {\n          _this4.$message.success('操作成功');\n\n          _this4.orderId = ''; // this.dialogOrderStatus = 0\n\n          _this4.dialogVisible = false;\n\n          _this4.getOrderListData(_this4.status);\n        } else {\n          _this4.$message.error(res.data.msg);\n        }\n      }).catch(function (err) {\n        _this4.$message.error('请求出错了：' + err.message);\n      });\n    } // 查看详情\n\n  }, {\n    key: \"goDetail\",\n    value: function () {\n      var _goDetail = (0, _asyncToGenerator2.default)(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(id, status, row, event) {\n        var _ref2, data;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                event.stopPropagation(); // console.log(111, index, row)\n\n                this.diaForm = [];\n                this.dialogVisible = true;\n                this.dialogOrderStatus = status;\n                _context2.next = 6;\n                return (0, _order.queryOrderDetailById)({\n                  orderId: id\n                });\n\n              case 6:\n                _ref2 = _context2.sent;\n                data = _ref2.data;\n                this.diaForm = data.data;\n                this.row = row;\n\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function goDetail(_x2, _x3, _x4, _x5) {\n        return _goDetail.apply(this, arguments);\n      }\n\n      return goDetail;\n    }() // 关闭弹层\n\n  }, {\n    key: \"handleClose\",\n    value: function handleClose() {\n      this.dialogVisible = false;\n    } // tab切换\n\n  }, {\n    key: \"handleClass\",\n    value: function handleClass(index) {\n      this.activeIndex = index;\n\n      if (index === 0) {\n        this.status = 2;\n        this.getOrderListData(2);\n      } else {\n        this.status = 3;\n        this.getOrderListData(3);\n      }\n    } // 触发table某一行\n\n  }, {\n    key: \"handleTable\",\n    value: function handleTable(row, column, event) {\n      event.stopPropagation();\n      this.goDetail(row.id, row.status, row, event);\n    } // 分页\n\n  }, {\n    key: \"handleSizeChange\",\n    value: function handleSizeChange(val) {\n      this.pageSize = val;\n      this.getOrderListData(this.status);\n    }\n  }, {\n    key: \"handleCurrentChange\",\n    value: function handleCurrentChange(val) {\n      this.page = val;\n      this.getOrderListData(this.status);\n    }\n  }, {\n    key: \"tabList\",\n    get: function get() {\n      return [{\n        label: '待接单',\n        value: 2,\n        num: this.orderStatics.toBeConfirmed\n      }, {\n        label: '待派送',\n        value: 3,\n        num: this.orderStatics.confirmed\n      }];\n    }\n  }]);\n  return default_1;\n}(_vuePropertyDecorator.Vue);\n\n(0, _tslib.__decorate)([(0, _vuePropertyDecorator.Prop)({\n  default: ''\n})], default_1.prototype, \"orderStatics\", void 0);\ndefault_1 = (0, _tslib.__decorate)([(0, _vuePropertyDecorator.Component)({\n  name: 'Orderview',\n  components: {\n    Empty: _index.default\n  }\n})], default_1);\nvar _default = default_1;\nexports.default = _default;",{"version":3,"sources":["C:\\cangqiongwaimai\\苍穹外卖前端课程\\代码\\day02\\project-sky-admin-vue-ts\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\cangqiongwaimai\\苍穹外卖前端课程\\代码\\day02\\project-sky-admin-vue-ts\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\cangqiongwaimai\\苍穹外卖前端课程\\代码\\day02\\project-sky-admin-vue-ts\\src\\views\\dashboard\\components\\orderList.vue?vue&type=script&lang=ts&"],"names":[],"mappings":"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","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop } from 'vue-property-decorator'\nimport Empty from '@/components/Empty/index.vue'\nimport {\n  getOrderDetailPage,\n  queryOrderDetailById,\n  completeOrder,\n  deliveryOrder,\n  orderCancel,\n  orderReject,\n  orderAccept,\n  getOrderListBy,\n} from '@/api/order'\n@Component({\n  name: 'Orderview',\n  components: {\n    Empty,\n  },\n})\nexport default class extends Vue {\n  @Prop({ default: '' }) orderStatics!: any\n\n  private orderId = '' //订单号\n  private dialogOrderStatus = 0 //弹窗所需订单状态，用于详情展示字段\n  private activeIndex = 0\n\n  private dialogVisible = false //详情弹窗\n  private cancelDialogVisible = false //取消，拒单弹窗\n  private cancelDialogTitle = '' //取消，拒绝弹窗标题\n  private cancelReason = ''\n  private remark = '' //自定义原因\n  private diaForm = []\n  private row = {}\n  private isAutoNext = true\n  private isSearch: boolean = false\n  private counts = 0\n  private page: number = 1\n  private pageSize: number = 10\n  private status = 2\n  private orderData = []\n  private isTableOperateBtn = true\n  private cancelOrderReasonList = [\n    {\n      value: 1,\n      label: '订单量较多，暂时无法接单',\n    },\n    {\n      value: 2,\n      label: '菜品已销售完，暂时无法接单',\n    },\n    {\n      value: 3,\n      label: '餐厅已打烊，暂时无法接单',\n    },\n    {\n      value: 0,\n      label: '自定义原因',\n    },\n  ]\n\n  private cancelrReasonList = [\n    {\n      value: 1,\n      label: '订单量较多，暂时无法接单',\n    },\n    {\n      value: 2,\n      label: '菜品已销售完，暂时无法接单',\n    },\n    {\n      value: 3,\n      label: '骑手不足无法配送',\n    },\n    {\n      value: 4,\n      label: '客户电话取消',\n    },\n    {\n      value: 0,\n      label: '自定义原因',\n    },\n  ]\n  private orderList = [\n    {\n      label: '全部订单',\n      value: 0,\n    },\n    {\n      label: '待付款',\n      value: 1,\n    },\n    {\n      label: '待接单',\n      value: 2,\n    },\n    {\n      label: '待派送',\n      value: 3,\n    },\n    {\n      label: '派送中',\n      value: 4,\n    },\n    {\n      label: '已完成',\n      value: 5,\n    },\n    {\n      label: '已取消',\n      value: 6,\n    },\n  ]\n  get tabList() {\n    return [\n      {\n        label: '待接单',\n        value: 2,\n        num: this.orderStatics.toBeConfirmed,\n      },\n      {\n        label: '待派送',\n        value: 3,\n        num: this.orderStatics.confirmed,\n      },\n    ]\n  }\n  created() {\n    this.getOrderListData(this.status)\n  }\n  // // 获取订单数据\n  async getOrderListData(status) {\n    const params = {\n      page: this.page,\n      pageSize: this.pageSize,\n      status: status,\n    }\n    const data = await getOrderDetailPage(params)\n    this.orderData = data.data.data.records\n    this.counts = data.data.data.total\n    this.$emit('getOrderListBy3Status')\n    if (\n      this.dialogOrderStatus === 2 &&\n      this.status === 2 &&\n      this.isAutoNext &&\n      !this.isTableOperateBtn &&\n      data.data.records.length > 1\n    ) {\n      const row = data.data.records[0]\n      this.goDetail(row.id, row.status, row, row)\n    } else {\n      return null\n    }\n  }\n\n  //接单\n  orderAccept(row: any, event) {\n    event.stopPropagation()\n    this.orderId = row.id\n    this.dialogOrderStatus = row.status\n    orderAccept({ id: this.orderId })\n      .then((res) => {\n        if (res.data.code === 1) {\n          this.$message.success('操作成功')\n          this.orderId = ''\n          // this.dialogOrderStatus = 0\n          this.dialogVisible = false\n          this.getOrderListData(this.status)\n        } else {\n          this.$message.error(res.data.msg)\n        }\n      })\n      .catch((err) => {\n        this.$message.error('请求出错了：' + err.message)\n      })\n  }\n  //打开取消订单弹窗\n  cancelOrder(row: any, event) {\n    event.stopPropagation()\n    this.cancelDialogVisible = true\n    this.orderId = row.id\n    this.dialogOrderStatus = row.status\n    this.cancelDialogTitle = '取消'\n    this.dialogVisible = false\n    this.cancelReason = ''\n  }\n  //打开拒单弹窗\n  orderReject(row: any, event) {\n    event.stopPropagation()\n    this.cancelDialogVisible = true\n    this.orderId = row.id\n    this.dialogOrderStatus = row.status\n    this.cancelDialogTitle = '拒绝'\n    this.dialogVisible = false\n    this.cancelReason = ''\n  }\n  //确认取消或拒绝订单并填写原因\n  confirmCancel(type) {\n    if (!this.cancelReason) {\n      return this.$message.error(`请选择${this.cancelDialogTitle}原因`)\n    } else if (this.cancelReason === '自定义原因' && !this.remark) {\n      return this.$message.error(`请输入${this.cancelDialogTitle}原因`)\n    }\n\n    ;(this.cancelDialogTitle === '取消' ? orderCancel : orderReject)({\n      id: this.orderId,\n      // eslint-disable-next-line standard/computed-property-even-spacing\n      [this.cancelDialogTitle === '取消' ? 'cancelReason' : 'rejectionReason']:\n        this.cancelReason === '自定义原因' ? this.remark : this.cancelReason,\n    })\n      .then((res) => {\n        if (res.data.code === 1) {\n          this.$message.success('操作成功')\n          this.cancelDialogVisible = false\n          this.orderId = ''\n          // this.dialogOrderStatus = 0\n          this.getOrderListData(this.status)\n        } else {\n          this.$message.error(res.data.msg)\n        }\n      })\n      .catch((err) => {\n        this.$message.error('请求出错了：' + err.message)\n      })\n  }\n\n  // 派送，完成\n  cancelOrDeliveryOrComplete(status: number, id: string, event) {\n    event.stopPropagation()\n    const params = {\n      status,\n      id,\n    }\n    ;(status === 3 ? deliveryOrder : completeOrder)(params)\n      .then((res) => {\n        if (res.data.code === 1) {\n          this.$message.success('操作成功')\n          this.orderId = ''\n          // this.dialogOrderStatus = 0\n          this.dialogVisible = false\n          this.getOrderListData(this.status)\n        } else {\n          this.$message.error(res.data.msg)\n        }\n      })\n      .catch((err) => {\n        this.$message.error('请求出错了：' + err.message)\n      })\n  }\n  // 查看详情\n  async goDetail(id: any, status: number, row: any, event) {\n    event.stopPropagation()\n    // console.log(111, index, row)\n    this.diaForm = []\n    this.dialogVisible = true\n    this.dialogOrderStatus = status\n    const { data } = await queryOrderDetailById({ orderId: id })\n    this.diaForm = data.data\n    this.row = row\n  }\n  // 关闭弹层\n  handleClose() {\n    this.dialogVisible = false\n  }\n  // tab切换\n  handleClass(index) {\n    this.activeIndex = index\n    if (index === 0) {\n      this.status = 2\n      this.getOrderListData(2)\n    } else {\n      this.status = 3\n      this.getOrderListData(3)\n    }\n  }\n  // 触发table某一行\n  handleTable(row, column, event) {\n    event.stopPropagation()\n    this.goDetail(row.id, row.status, row, event)\n  }\n  // 分页\n  private handleSizeChange(val: any) {\n    this.pageSize = val\n    this.getOrderListData(this.status)\n  }\n\n  private handleCurrentChange(val: any) {\n    this.page = val\n    this.getOrderListData(this.status)\n  }\n}\n"],"sourceRoot":""}]}